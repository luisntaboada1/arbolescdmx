{% load static %}

<!DOCTYPE html>
<html>
    <head>
        <title>Registro arbol</title>
        <link rel="stylesheet" href="{% static 'treecontrol1/css/register_tree_general.css' %}">
        <link rel="stylesheet" href="{% static 'treecontrol1/css/register_tree_header.css' %}">
        <link rel="stylesheet" href="{% static 'treecontrol1/css/register_tree_photos.css' %}">
        <link rel="stylesheet" href="{% static 'treecontrol1/css/register_tree_form.css' %}">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    </head>

    <body>
        <div class="header"></div>
        
        <div class="photos">
            <p>Subir hasta 4 fotos del arbol</p>
            <div class="foto_principal">
                <label for="foto_principal">
                    <input class="input_foto_principal" type="file" accept="image/*" id="foto_principal" name="foto_principal" hidden>
                    <img class="" src="{% static 'treecontrol1/images/camera.jpg' %}" alt="Foto1">
                </label>
            </div>
            
            <div class="fotos_secundarias">
                <label for="foto_secundaria1">
                    <input class="input_foto_secundaria" type="file" accept="image/*" name="foto_secundaria1" hidden>
                    <img class="" src="{% static 'treecontrol1/images/camera.jpg' %}" alt="Foto1">
                </label>
                
                <label for="foto_secundaria2">
                    <input class="input_foto_secundaria" type="file" accept="image/*" name="foto_secundaria2" hidden>
                    <img class="" src="{% static 'treecontrol1/images/camera.jpg' %}" alt="Foto2">
                </label>

                <label for="foto_secundaria3">
                    <input class="input_foto_secundaria" type="file" accept="image/*" name="foto_secundaria3" hidden>
                    <img class="" src="{% static 'treecontrol1/images/camera.jpg' %}" alt="Foto3">
                </label>
                
            </div>
        </div>

        
        <form class="tree-registration" method="post" enctype="multipart/form-data">
        
        {% csrf_token %}
        <div class="form">
            {% if form.instance.pk %}
                <p><strong>Editando arbol: #{{form.instance.pk}}</strong_></p>
                <p>-----------------------</p>
            {% endif %}
            
            <div class="species_form">
                {% if form.errors %}
                <div class="alert alert-danger">
                    <p><strong>Error al registrar:</strong></p>
                    <ul>
                    {# Field‐specific errors #}
                    {% for field in form %}
                        {% for error in field.errors %}
                        <li>{{ field.label }}: {{ error }}</li>
                        {% endfor %}
                    {% endfor %}

                    {# Non‐field errors (e.g. clean()‐level) #}
                    {% for error in form.non_field_errors %}
                        <li>{{ error }}</li>
                    {% endfor %}
                    </ul>
                </div>
                {% endif %}

                {% if success %}
                <div class="alert alert-success">
                    
                    <p><strong>Arbol registrado correctamente</strong></p>
                </div>
                {% endif %}

                <p>Especie</p>
                {{form.species}}
                
                {% if form.non_field_errors %}
                    <p class="error">{{ form.non_field_errors }}</p>
                {% endif %}
                
                {{form.species_selection}}
                
                {% if form.species.errors %}
                    <p class="error">{{ form.species.errors }}</p>
                {% endif %}
            </div>
            
            
            <p>Dirección mas cercana</p>
            <div class="directions_form">
                <div class="d1">
                    
                    {{form.alcaldia}}

                    {% if form.alcaldia.errors %}
                        <p class="error">{{ form.alcaldia.errors }}</p>
                    {% endif %}

                    {{form.colonia}}

                    {% if form.colonia.errors %}
                        <p class="error">{{ form.colonia.errors }}</p>
                    {% endif %}
                </div>

                <div class="d2">
                    {{form.calle}}
                    {% if form.calle.errors %}
                        <p class="error">{{ form.calle.errors }}</p>
                    {% endif %}
                    
                    {{form.num}}

                    {% if form.num.errors %}
                        <p class="error">{{ form.num.errors }}</p>
                    {% endif %}
                    
                    {{form.cp}}
                    {% if form.cp.errors %}
                        <p class="error">{{ form.cp.errors }}</p>
                    {% endif %}
                </div>

                <div class="d3">
                    {{form.reference}}

                    {% if form.reference.errors %}
                        <p class="error">{{ form.reference.errors }}</p>
                    {% endif %}
                    
                    {{form.latitude}}

                    {% if form.latitude.errors %}
                        <p class="error">{{ form.latitude.errors }}</p>
                    {% endif %}
                    
                    {{form.longitude}}

                    {% if form.longitude.errors %}
                        <p class="error">{{ form.longitude.errors }}</p>
                    {% endif %}   
                </div>

            </div>
            
            <p>Dimensiones</p>
            <div class="dimensions_form">
                {{form.height}}
                {% if form.height.errors %}
                    <p class="error">{{ form.height.errors }}</p>
                {% endif %}

                {{form.base_diameter}}
                {% if form.base_diameter.errors %}
                    <p class="error">{{ form.base_diameter.errors }}</p>
                {% endif %}

                {{form.crown_diameter}}
                {% if form.crown_diameter.errors %}
                    <p class="error">{{ form.crown_diameter.errors }}</p>
                {% endif %}

                {{form.trunk_diameter}}
                {% if form.trunk_diameter.errors %}
                    <p class="error">{{ form.trunk_diameter.errors }}</p>
                {% endif %}

                {{form.trunk_diameter}}
                {% if form.trunk_inclination.errors %}
                    <p class="error">{{ form.trunk_inclination.errors }}</p>
                {% endif %}

               {{form.structure}}

                {% if form.structure.errors %}
                    <p class="error">{{ form.structure.errors }}</p>
                {% endif %}

            </div>

            <p>Salud</p>
            <div class="health_form">
                {{form.health_status}}
                {% if form.health_status.errors %}
                    <p class="error">{{ form.health_status.errors }}</p>
                {% endif %}

            </div>

            <p>Acciones necesarias (opcional)</p>
            <div class="actions_form">
                <select class="select_action">
                    <option value="" disabled selected>--Seleccione una accion--</option>
                    <option value="podar">Podar</option>
                    <option value="talar">Talar</option>
                    <option value="desinfectar">Desinfectar</option>
                    <option value="trasplantar">Trasplantar</option>
                    <option value="otro">Otro</option>
                </select>
                
                <select class="action_urgency">
                    <option value="" disabled selected>--Seleccione la urgencia--</option>
                    <option value="baja">1.Muy Baja</option>
                    <option value="moderada">2. Moderada</option>
                    <option value="alta">3. Alta</option>
                    <option value="muy alta">4. Muy Alta</option>
                </select>

                <select class="input_action_description">
                    <option value="" disabled selected>--Seleccione la descripcion de la accion--</option>
                    <option value="obstruccion">Obstruccion de infraestructura</option>
                    <option value="riesgo">Riesgo de caida</option>
                    <option value="enfermedad">Plagas</option>
                    <option value="otro">Otro</option>
                    
                </select>


            </div>

            <div>
                <p>Ultima inspeccion</p>
                {{form.last_inspection}}
                {% if form.last_inspection.errors %}
                    <p class="error">{{ form.last_inspection.errors }}</p>
                {% endif %}
            </div>

            <div class="submit">
                <button class="submit_button" type="submit">Registrar</button>
            </div>

        </div> 
        </form>     
    
    </body>

</html>